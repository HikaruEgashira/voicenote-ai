# UI/UX バックログ

モバイルファーストの観点で発見されたUI/UX問題のリストです。

## 優先度: 高 (Mobile Critical)

### 1. フィルターUIの横スクロール問題
- **画面**: notes.tsx (ノート一覧)
- **問題**: フィルターボタン（すべて/文字起こし済/要約済/ハイライト/未完了タスク）が横に並んでいるが、モバイル画面幅では収まりきらず、レイアウトが崩れる可能性がある
- **場所**: `app/(tabs)/notes.tsx:711-777`
- **推奨修正**: `flexWrap: "wrap"`は設定されているが、ボタンが多すぎる。優先度の低いフィルターは折りたたみメニューに移動するか、スマートフォルダーと統合する

### 2. 検索履歴ドロップダウンのz-index問題
- **画面**: notes.tsx (ノート一覧)
- **問題**: 検索履歴ドロップダウンが他の要素と重なる可能性がある。zIndex: 100だけでは、SafeAreaやタブバーとの衝突を完全に防げない
- **場所**: `app/(tabs)/notes.tsx:681-707`
- **推奨修正**: Modalまたはポータルベースのドロップダウンに変更

### 3. ノート詳細画面のQ&A入力欄がキーボードに隠れる
- **画面**: note/[id].tsx (ノート詳細)
- **問題**: KeyboardAvoidingViewを使用しているが、Q&Aタブの入力欄がキーボード出現時に正しく動作しない場合がある
- **場所**: `app/note/[id].tsx:1689-1723`
- **推奨修正**: KeyboardAvoidingViewのbehaviorとkeyboardVerticalOffsetを調整し、タブバーの高さを考慮する

### 4. タブバーのタップ領域が小さい
- **画面**: note/[id].tsx (ノート詳細)
- **問題**: タブ（音声/文字起こし/要約/Q&A）のタップ領域がpaddingVertical: 12pxと小さく、タップしにくい
- **場所**: `app/note/[id].tsx:1798-1805`
- **推奨修正**: 最小タップ領域を44x44pxに拡大（iOS Human Interface Guidelines準拠）

### 5. 長いタイトルの切り詰め表示が不十分
- **画面**: notes.tsx, note/[id].tsx
- **問題**: numberOfLines={1}でタイトルを切り詰めているが、切り詰め時の視覚的フィードバック（...）が見えにくい
- **場所**: `app/(tabs)/notes.tsx:184`, `app/note/[id].tsx:807-809`
- **推奨修正**: ellipsizeMode="tail"を明示的に設定し、最小幅を確保

## 優先度: 中 (Mobile Important)

### 6. 波形表示の固定バー数
- **画面**: record.tsx, note/[id].tsx
- **問題**: 波形バーの数が50本に固定されており、画面幅に関係なく同じ数を表示。狭い画面ではバーが詰まりすぎる
- **場所**: `app/(tabs)/record.tsx:244`, `app/note/[id].tsx:865`
- **推奨修正**: 画面幅に基づいて動的にバー数を計算（例：Math.floor(screenWidth / 8)）

### 7. ハイライトボタンのタップ領域
- **画面**: note/[id].tsx
- **問題**: 「現在位置をハイライト」ボタンは目立つが、ハイライト削除ボタン（×アイコン）が小さすぎる（padding: 6px）
- **場所**: `app/note/[id].tsx:1915-1917`
- **推奨修正**: 削除ボタンのタップ領域を拡大し、最小44x44pxを確保

### 8. 日付入力のUX問題
- **画面**: note/[id].tsx (アクションアイテムの期限設定)
- **問題**: TextInputでYYYY-MM-DD形式の入力を求めているが、モバイルではDatePickerを使うべき
- **場所**: `app/note/[id].tsx:1283-1302`
- **推奨修正**: @react-native-community/datetimepickerを使用してネイティブの日付選択UIを提供

### 9. 感情分析の感情バー幅が固定
- **画面**: note/[id].tsx
- **問題**: 感情バーの幅が画面幅に対して固定されておらず、狭い画面でラベルとバーが重なる可能性
- **場所**: `app/note/[id].tsx:2264-2283`
- **推奨修正**: emotionLabelのwidth: 40を相対値に変更、または縦並びレイアウトを検討

### 10. スマートフォルダーの横スクロールインジケーター不在
- **画面**: notes.tsx
- **問題**: showsHorizontalScrollIndicator={false}でスクロールインジケーターを非表示にしているが、ユーザーがスクロール可能であることに気づかない
- **場所**: `app/(tabs)/notes.tsx:611-614`
- **推奨修正**: フェードアウトエッジエフェクトを追加するか、矢印インジケーターを表示

### 11. 再生速度ボタンのフィードバック不足
- **画面**: note/[id].tsx
- **問題**: 再生速度変更時の視覚的フィードバックがテキスト変更のみ。モバイルではより明確なフィードバックが必要
- **場所**: `app/note/[id].tsx:924-932`
- **推奨修正**: 速度変更時にトースト通知を追加、またはボタンのアニメーションを追加

### 12. 翻訳ボタンのローディング状態が小さい
- **画面**: note/[id].tsx
- **問題**: 翻訳中のActivityIndicatorが小さく、処理中であることがわかりにくい
- **場所**: `app/note/[id].tsx:1050-1053`
- **推奨修正**: ボタン全体をローディング状態にするか、オーバーレイ表示を追加

## 優先度: 低 (Nice to have)

### 13. RecordingCardのスワイプ削除の発見性
- **画面**: notes.tsx
- **問題**: スワイプで削除できることがユーザーに伝わりにくい。長押しでも削除できるが、オンボーディングがない
- **場所**: `app/(tabs)/notes.tsx:278-286`
- **推奨修正**: 初回使用時にヒントを表示するか、スワイプインジケーターを追加

### 14. タグチップのカラー視認性
- **画面**: notes.tsx, note/[id].tsx
- **問題**: タグの背景色が設定されている場合、テキストが白固定のため、明るい背景色では視認性が悪い
- **場所**: `app/(tabs)/notes.tsx:243-251`
- **推奨修正**: 背景色の明度に基づいてテキスト色を自動調整

### 15. 要約セクションのスクロール位置
- **画面**: note/[id].tsx
- **問題**: 要約タブに多くのセクション（概要/重要なポイント/タグ/アクションアイテム/キーワード/感情分析/メモ）があり、下部のセクションにアクセスしにくい
- **場所**: `app/note/[id].tsx:1091-1633`
- **推奨修正**: セクションヘッダーをスティッキーにするか、セクションジャンプメニューを追加

### 16. GlobalRecordingBarの視認性
- **画面**: 全画面
- **問題**: 録音中のグローバルバーが下部に固定されているが、タブバーと重なる場合がある
- **場所**: `packages/components/global-recording-bar.tsx`
- **推奨修正**: タブバーの上に配置し、SafeAreaを考慮した高さ調整

### 17. 一括選択モードの操作性
- **画面**: notes.tsx
- **問題**: 選択モード中のUIが通常モードと似すぎており、現在のモードがわかりにくい
- **場所**: `app/(tabs)/notes.tsx:585-605`
- **推奨修正**: 選択モード時にヘッダー背景色を変更するなど、より明確な視覚的区別を追加

### 18. 空状態の画像/イラスト不在
- **画面**: notes.tsx
- **問題**: 空状態でアイコンのみ表示されており、感情的なつながりが弱い
- **場所**: `app/(tabs)/notes.tsx:563-573`
- **推奨修正**: カスタムイラストを追加して、より親しみやすいデザインに

---

## ビューポート別の問題 (Responsive Issues)

各画面サイズでの固有の問題を特定。テスト用ストーリー: `Viewport/ResponsiveIssues`

### iPhone SE (375x667) - 最小ビューポート

#### V1. フィルターボタンがソートボタンを押し出す
- **画面**: notes.tsx
- **問題**: フィルター行（filterRow）で`justifyContent: "space-between"`を使用しているが、filterButtonsが折り返すとsortAndViewButtonsが画面外に押し出される
- **場所**: `app/(tabs)/notes.tsx:1059-1065`
- **再現**: 375px幅でフィルターボタン5つ + ソートボタンを表示
- **推奨修正**: フィルター行を2段構成にするか、フィルターをドロップダウンに変更

#### V2. 波形バーのオーバーフロー
- **画面**: record.tsx, note/[id].tsx
- **問題**: 50本のバー × 3px幅 + 隙間 = 約250px必要だが、padding込みで375px画面に収まらずバーが詰まる
- **場所**: `app/(tabs)/record.tsx:244`
- **計算**: `(50 * 3) + (49 * gap) + (padding * 2)` で容易にオーバーフロー
- **推奨修正**: `Math.floor((containerWidth - padding * 2) / 6)` でバー数を動的計算

#### V3. 統計グリッドの4項目配置問題
- **画面**: settings.tsx
- **問題**: `width: "50%"`で2列配置だが、375pxでは各セルが187.5pxとなり、fontSize: 28の数値が切れる場合がある
- **場所**: `app/(tabs)/settings.tsx:1150`
- **推奨修正**: 最小幅での1列フォールバック、または数値フォントサイズの動的調整

#### V4. スマートフォルダーが画面幅を超える
- **画面**: notes.tsx
- **問題**: 4つのスマートフォルダー全てが375pxに収まらないが、スクロール可能であることが視覚的に不明確
- **場所**: `app/(tabs)/notes.tsx:610-651`
- **推奨修正**: 右端にフェードグラデーション、または「>」インジケーター追加

### iPad Mini (768x1024) - ブレークポイント境界

#### V5. カードグリッドの余白不均一
- **画面**: notes.tsx
- **問題**: `Math.floor(100 / columns) - 2`% の計算で、2カラム時は48%×2=96%、残り4%が余白となるがgap: 12pxとの整合性がない
- **場所**: `app/(tabs)/notes.tsx:153`
- **計算**: 768px × 48% = 368.64px per card, gap 12px, total 749.28px (18.72px余剰)
- **推奨修正**: flexboxのgapとwidth計算を整合させる: `calc((100% - gap) / 2)`相当のロジックに変更

#### V6. サイドバー表示切り替えの急激さ
- **画面**: _layout.tsx
- **問題**: 768pxで突然サイドバーが表示され、レイアウトが大きく変化する。アニメーションなし
- **場所**: `app/(tabs)/_layout.tsx:18`, `packages/hooks/use-responsive.ts:14`
- **推奨修正**: サイドバー表示にアニメーションを追加、または中間状態（折りたたみ可能サイドバー）を導入

#### V7. デスクトップモードでのタッチターゲット
- **画面**: 全画面
- **問題**: 768px以上でisDesktop=trueになるが、iPadはタッチデバイス。デスクトップ向けの小さいUIになる
- **場所**: `packages/hooks/use-responsive.ts:29`
- **推奨修正**: `isDesktop`の判定にポインタータイプ（coarse/fine）を追加

### iPad Pro 12.9" (1024x1366) - Regular レイアウト

#### V8. コンテンツの過剰な余白
- **画面**: record.tsx
- **問題**: `maxWidth: 900`で中央寄せだが、1024pxではサイドの余白が62pxとなり、画面を有効活用できていない
- **場所**: `app/(tabs)/record.tsx:412-415`
- **推奨修正**: maxWidthを画面幅に応じて動的に調整、またはサイドパネルを追加

#### V9. ノートリストの3カラム移行点
- **画面**: notes.tsx
- **問題**: 1024pxでは2カラムだが、スクロールが長くなる。3カラムへの移行点（1200px）が高すぎる
- **場所**: `packages/hooks/use-responsive.ts:17`
- **推奨修正**: 1024px以上で3カラムに変更、または画面高さも考慮した判定

### Desktop Wide (1920x1080) - 最大ビューポート

#### V10. 極端な横余白
- **画面**: notes.tsx
- **問題**: `maxWidth: 1200`で3カラム表示だが、1920pxでは両サイドに360pxの余白が発生
- **場所**: `app/(tabs)/notes.tsx:1117-1120`
- **推奨修正**: 4カラム以上への対応、またはmaxWidthの緩和（1440pxなど）

#### V11. 録音画面の大きすぎる録音ボタン
- **画面**: record.tsx
- **問題**: 96x96pxの録音ボタンは小さい画面では適切だが、1920px画面では相対的に小さく見える
- **場所**: `app/(tabs)/record.tsx:519-530`
- **推奨修正**: 画面サイズに応じてボタンサイズをスケール（最大128px）

#### V12. 波形表示領域の無駄
- **画面**: record.tsx, note/[id].tsx
- **問題**: 波形の高さが120px固定で、広い画面でも同じ高さ。バー50本が疎になりすぎる
- **場所**: `app/(tabs)/record.tsx:497-502`
- **推奨修正**: 画面幅に応じてバー数を増加（最大100本）し、高さも動的調整

### 全ビューポート共通

#### V13. SafeArea対応の不整合
- **画面**: 全画面
- **問題**: SafeAreaProviderを使用しているが、一部コンポーネントでハードコードされたpaddingがある
- **場所**: 複数ファイル
- **例**: `paddingBottom: 72`（`app/(tabs)/record.tsx:409`）がタブバー高さと一致しない場合がある
- **推奨修正**: useSafeAreaInsetsを使用して動的に調整

#### V14. 横向き（Landscape）未対応
- **画面**: 全画面
- **問題**: iPad横向き（1366x1024）やiPhone横向き（844x390）でのレイアウトが未検証
- **推奨修正**: 横向き時のレイアウト調整を追加（特に録音画面とノート詳細）

#### V15. フォントサイズのスケーリング
- **画面**: 全画面
- **問題**: アクセシビリティ設定で大きいフォントサイズが設定された場合、固定サイズのコンテナからテキストがはみ出す
- **推奨修正**: Text要素にmaxFontSizeMultiplierを設定、またはコンテナサイズを動的に調整

---

## ビューポートテスト用ストーリー

以下のストーリーで各ビューポートでの問題を視覚的に確認可能:
- `Viewport/ResponsiveIssues/FiltersiPhoneSE` - フィルター問題（iPhone SE）
- `Viewport/ResponsiveIssues/TabsiPhoneSE` - タブバー問題（iPhone SE）
- `Viewport/ResponsiveIssues/WaveformiPhoneSE` - 波形問題（iPhone SE）
- `Viewport/ResponsiveIssues/CardsiPadMini` - カードグリッド問題（iPad Mini）
- `Viewport/ResponsiveIssues/CardsDesktopWide` - 余白問題（Desktop）

---

## 実装メモ

- 各問題にはStorybookストーリーを作成して視覚的に確認可能
- タップ領域の問題は、Storybookで各状態をテストすることで確認可能
- レスポンシブ問題は、異なる画面サイズでStorybookを確認することで検証可能
- ビューポートテストには `viewport-test.stories.tsx` を使用
